<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.19.3">
    <title>Xlsxir.SaxParser â€” Xlsxir v1.6.3</title>
    <link rel="stylesheet" href="dist/html-399e30b9b028e3059575.css" />
      <link rel="canonical" href="https://hexdocs.pm/xlsxir/Xlsxir.SaxParser.html" />
    <script src="dist/sidebar_items-ae9c76d27c.js"></script>
    <script async src="dist/html-399e30b9b028e3059575.js"></script>
    
  </head>
  <body data-type="modules">
    <script>try { if(localStorage.getItem('night-mode')) document.body.className += ' night-mode'; } catch (e) { }</script>
    <div class="main">
<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" aria-hidden="true"></span>
  <span class="sr-only">Toggle Sidebar</span>
</button>
<button class="sidebar-button night-mode-toggle">
  <span class="icon-theme" aria-hidden="true"></span>
  <span class="sr-only">Toggle Theme</span>
</button>
<section class="sidebar">

  <a href="overview.html" class="sidebar-projectLink">
    <div class="sidebar-projectDetails">
      <h1 class="sidebar-projectName">
Xlsxir      </h1>
      <h2 class="sidebar-projectVersion">
        v1.6.3
      </h2>
    </div>
  </a>

  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
    <input name="q" type="text" id="search-list" class="search-input" placeholder="Search" aria-label="Search" autocomplete="off" />
  </form>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">Pages</a></li>

      <li><a id="modules-list" href="#full-list">Modules</a></li>

      <li><a id="exceptions-list" href="#full-list">Exceptions</a></li>

  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">


      <h1>
        <small class="visible-xs">Xlsxir v1.6.3</small>
Xlsxir.SaxParser        
          <a href="https://github.com/jsonkenl/xlsxir/blob/master/lib/xlsxir/sax_parser.ex#L1" title="View Source" class="view-source" rel="help">
            <span class="icon-code" aria-hidden="true"></span>
            <span class="sr-only">View Source</span>
          </a>
      </h1>


        <section id="moduledoc">
<p>Provides SAX (Simple API for XML) parsing functionality of the <code class="inline">.xlsx</code> file via the <a href="https://github.com/willemdj/erlsom">Erlsom</a> Erlang library. SAX (Simple API for XML) is an event-driven
parsing algorithm for parsing large XML files in chunks, preventing the need to load the entire DOM into memory. Current chunk size is set to 10,000.</p>
        </section>

        <section id="summary" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#summary">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
            Summary
          </h1>
  <div class="summary-functions summary">
    <h2>
      <a href="#functions">Functions</a>
    </h2>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#parse/3">parse(xml_file, type, excel \\ nil)</a>
  </div>
    <div class="summary-synopsis"><p>Parses <code class="inline">XmlFile</code> (<code class="inline">xl/worksheets/sheet#{n}.xml</code> at index <code class="inline">n</code>, <code class="inline">xl/styles.xml</code>, <code class="inline">xl/workbook.xml</code> or <code class="inline">xl/sharedStrings.xml</code>) using SAX parsing. An Erlang Term Storage (ETS) process is started to hold the state of data
parsed. The style and sharedstring XML files (if they exist) must be parsed first in order for the worksheet parser to sucessfully complete</p>
</div>
</div>
  </div>
        </section>

        <section id="functions" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#functions">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
Functions          </h1>
          <div class="functions-list">
<section class="detail" id="parse/3">
  
    <span id="parse/2"></span>
  <div class="detail-header">
    <a href="#parse/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">parse(xml_file, type, excel \\ nil)</span>
      <a href="https://github.com/jsonkenl/xlsxir/blob/master/lib/xlsxir/sax_parser.ex#L54" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
          </div>
  <section class="docstring">
<p>Parses <code class="inline">XmlFile</code> (<code class="inline">xl/worksheets/sheet#{n}.xml</code> at index <code class="inline">n</code>, <code class="inline">xl/styles.xml</code>, <code class="inline">xl/workbook.xml</code> or <code class="inline">xl/sharedStrings.xml</code>) using SAX parsing. An Erlang Term Storage (ETS) process is started to hold the state of data
parsed. The style and sharedstring XML files (if they exist) must be parsed first in order for the worksheet parser to sucessfully complete.</p>
<h2 id="parse/3-parameters" class="section-heading">
  <a href="#parse/3-parameters" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Parameters
</h2>

<ul>
<li><code class="inline">content</code> - XML string to parse
</li>
<li><code class="inline">type</code> - file type identifier (:worksheet, :style or :string) of XML file to be parsed
</li>
<li><code class="inline">max_rows</code> - the maximum number of rows in this worksheet that should be parsed
</li>
</ul>
<h2 id="parse/3-example" class="section-heading">
  <a href="#parse/3-example" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Example
</h2>

<p>  An example file named <code class="inline">test.xlsx</code> located in <code class="inline">./test/test_data</code> containing the following in worksheet at index <code class="inline">0</code>:</p>
<ul>
<li>cell &#39;A1&#39; -&gt; &quot;string one&quot;
</li>
<li>cell &#39;B1&#39; -&gt; &quot;string two&quot;
</li>
<li>cell &#39;C1&#39; -&gt; integer of 10
</li>
<li>cell &#39;D1&#39; -&gt; formula of <code class="inline">=4*5</code>
</li>
<li><p>cell &#39;E1&#39; -&gt; date of 1/1/2016 or Excel date serial of 42370
  The <code class="inline">.xlsx</code> file contents have been extracted to <code class="inline">./test/test_data/test</code>. For purposes of this example, we utilize the <code class="inline">get_at/1</code> function of each ETS process module to pull a sample of the parsed
  data. Keep in mind that the worksheet data is stored in the ETS process as a list of row lists, so the <code class="inline">Xlsxir..get_row/2</code> function will return a full row of values.</p>
<p>iex&gt; {:ok, %Xlsxir.ParseStyle{tid: tid1}, <em>} = Xlsxir.SaxParser.parse(%Xlsxir.XmlFile{content: File.read!(&quot;./test/test_data/test/xl/styles.xml&quot;)}, :style)
iex&gt; :ets.lookup(tid1, 0)
[{0, nil}]
iex&gt; {:ok, %Xlsxir.ParseString{tid: tid2}, </em>} = Xlsxir.SaxParser.parse(%Xlsxir.XmlFile{content: File.read!(&quot;./test/test<em>data/test/xl/sharedStrings.xml&quot;)}, :string)
iex&gt; :ets.lookup(tid2, 0)
[{0, &quot;string one&quot;}]
iex&gt; {:ok, %Xlsxir.ParseWorkbook{tid: tid3}, </em>} = Xlsxir.SaxParser.parse(%Xlsxir.XmlFile{content: File.read!(&quot;./test/test<em>data/test/xl/workbook.xml&quot;)}, :workbook)
iex&gt; :ets.lookup(tid3, 1)
[{1, &quot;Sheet1&quot;}]
iex&gt; {:ok, %Xlsxir.ParseWorksheet{tid: tid4}, </em>} = Xlsxir.SaxParser.parse(%Xlsxir.XmlFile{name: &quot;sheet1.xml&quot;, content: File.read!(&quot;./test/test_data/test/xl/worksheets/sheet1.xml&quot;)}, :worksheet, %Xlsxir.XlsxFile{shared_strings: tid2, styles: tid1, workbook: tid3})
iex&gt; :ets.lookup(tid4, 1)
[{1, [[&quot;A1&quot;, &quot;string one&quot;], [&quot;B1&quot;, &quot;string two&quot;], [&quot;C1&quot;, 10], [&quot;D1&quot;, 20], [&quot;E1&quot;, {2016, 1, 1}]]}]</p>
</li>
</ul>
  </section>
</section>
          </div>
        </section>
          <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.19.3),
          </span>
          <span class="line">
            designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
            </span>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>
  
  </body>
</html>

